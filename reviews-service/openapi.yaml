openapi: 3.0.3
info:
  title: Reviews Service API
  description: Product reviews and ratings with AI moderation
  version: 1.0.0
servers:
  - url: http://localhost:8084
    description: Local development
tags:
  - name: Reviews
  - name: Media
  - name: Reactions
  - name: Comments
  - name: Moderation
  - name: Analytics

paths:
  /api/v1/reviews:
    get:
      tags: [Reviews]
      summary: List reviews
      operationId: listReviews
      parameters:
        - name: product_id
          in: query
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, approved, rejected]
      responses:
        '200':
          description: Reviews list
    post:
      tags: [Reviews]
      summary: Create review
      operationId: createReview
      security:
        - bearerAuth: []
      responses:
        '201':
          description: Review created

  /api/v1/reviews/{id}:
    get:
      tags: [Reviews]
      summary: Get review
      operationId: getReview
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Review details
    put:
      tags: [Reviews]
      summary: Update review
      operationId: updateReview
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Review updated
    delete:
      tags: [Reviews]
      summary: Delete review
      operationId: deleteReview
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Review deleted

  /api/v1/reviews/{id}/status:
    put:
      tags: [Moderation]
      summary: Update review status
      operationId: updateReviewStatus
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Status updated

  /api/v1/reviews/bulk/status:
    post:
      tags: [Moderation]
      summary: Bulk update status
      operationId: bulkUpdateStatus
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Statuses updated

  /api/v1/reviews/bulk/moderate:
    post:
      tags: [Moderation]
      summary: Bulk moderate
      operationId: bulkModerate
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Reviews moderated

  /api/v1/reviews/{id}/media:
    get:
      tags: [Media]
      summary: Get review media
      operationId: getReviewMedia
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Media list
    post:
      tags: [Media]
      summary: Add media
      operationId: addMedia
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '201':
          description: Media added

  /api/v1/reviews/{id}/media/{mediaId}:
    delete:
      tags: [Media]
      summary: Delete media
      operationId: deleteMedia
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: mediaId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Media deleted

  /api/v1/reviews/media/upload:
    post:
      tags: [Media]
      summary: Upload review media
      operationId: uploadReviewMedia
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Media uploaded

  /api/v1/reviews/{id}/media/presigned-url:
    post:
      tags: [Media]
      summary: Generate presigned URL
      operationId: generateMediaPresignedUrl
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Presigned URL

  /api/v1/reviews/{id}/reactions:
    post:
      tags: [Reactions]
      summary: Add reaction
      operationId: addReaction
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '201':
          description: Reaction added

  /api/v1/reviews/{id}/reactions/{reactionId}:
    delete:
      tags: [Reactions]
      summary: Remove reaction
      operationId: removeReaction
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: reactionId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Reaction removed

  /api/v1/reviews/{id}/comments:
    post:
      tags: [Comments]
      summary: Add comment
      operationId: addComment
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '201':
          description: Comment added

  /api/v1/reviews/{id}/comments/{commentId}:
    put:
      tags: [Comments]
      summary: Update comment
      operationId: updateComment
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: commentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Comment updated
    delete:
      tags: [Comments]
      summary: Delete comment
      operationId: deleteComment
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: commentId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Comment deleted

  /api/v1/reviews/{id}/report:
    post:
      tags: [Moderation]
      summary: Report review
      operationId: reportReview
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Review reported

  /api/v1/reviews/{id}/moderate/ai:
    post:
      tags: [Moderation]
      summary: AI moderation
      operationId: aiModerate
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: AI moderation result

  /api/v1/reviews/similar/{id}:
    get:
      tags: [Reviews]
      summary: Find similar reviews
      operationId: findSimilarReviews
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Similar reviews

  /api/v1/reviews/search:
    post:
      tags: [Reviews]
      summary: Search reviews
      operationId: searchReviews
      responses:
        '200':
          description: Search results

  /api/v1/reviews/trending:
    get:
      tags: [Reviews]
      summary: Get trending reviews
      operationId: getTrendingReviews
      responses:
        '200':
          description: Trending reviews

  /api/v1/reviews/analytics:
    get:
      tags: [Analytics]
      summary: Get analytics
      operationId: getAnalytics
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Analytics data

  /api/v1/reviews/stats:
    get:
      tags: [Analytics]
      summary: Get statistics
      operationId: getStats
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Statistics

  /api/v1/reviews/export:
    post:
      tags: [Analytics]
      summary: Export reviews
      operationId: exportReviews
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Export initiated

  /health:
    get:
      summary: Health check
      responses:
        '200':
          description: Healthy

  /ready:
    get:
      summary: Readiness check
      responses:
        '200':
          description: Ready

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
